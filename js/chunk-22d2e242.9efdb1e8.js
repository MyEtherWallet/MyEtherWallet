(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22d2e242"],{"42c8":function(t,e,i){"use strict";i("b56e")},"58cd":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"py-8 px-8 moonpay-buy-component"},[i("div",{staticClass:"mt-2"},[i("div",{staticClass:"font-weight-medium textDark--text mb-2"},[t._v(" How much do you want to spend? ")]),i("div",{staticClass:"d-flex align-center"},[i("mew-input",{staticClass:"no-right-border",staticStyle:{"max-height":"92px","max-width":"251px"},attrs:{"hide-clear-btn":"",type:"number","error-messages":t.amountErrorMessages},nativeOn:{keydown:function(e){return t.preventCharE(e)}},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}),i("mew-select",{staticClass:"selectedFiat no-left-border",staticStyle:{"max-width":"135px","margin-top":"-30px"},attrs:{items:t.fiatCurrencyItems,"is-custom":""},model:{value:t.selectedFiat,callback:function(e){t.selectedFiat=e},expression:"selectedFiat"}})],1)]),i("div",{staticClass:"mt-2"},[i("div",{staticClass:"d-flex align-center mb-2"},[i("div",{staticClass:"font-weight-medium textDark--text mr-1"},[t._v("You will get")]),i("mew-tooltip",{staticStyle:{height:"21px"},scopedSlots:t._u([{key:"contentSlot",fn:function(){return[i("div",[t._v(" "+t._s(t.includesFeeText)+" "),i("br"),i("br"),t._v(" "+t._s(t.networkFeeText)+" "),i("br"),i("br"),t._v(" "+t._s(t.dailyLimit)+" "),i("br"),t._v(" "+t._s(t.monthlyLimit)+" ")])]},proxy:!0}])})],1),i("div",{staticClass:"d-flex align-start"},[i("mew-input",{staticClass:"no-right-border",attrs:{"is-read-only":"",value:t.loading?"Loading...":t.cryptoToFiat+" "+t.selectedCryptoName+" â‰ˆ "+t.plusFeeF+" ","hide-clear-btn":""}}),i("div",{staticClass:"d-flex align-center token-select-button",on:{click:function(e){t.openTokenSelect=!0}}},[i("mew-token-container",{attrs:{img:t.selectedCurrency.img,size:"28px"}}),i("div",{staticClass:"basic--text",staticStyle:{"margin-left":"8px"}},[t._v(" "+t._s(t.selectedCurrency.name)+" ")]),i("v-icon",{staticClass:"ml-auto",attrs:{size:"20px",color:"titlePrimary"}},[t._v(" mdi-chevron-down ")])],1)],1)]),t.inWallet?t._e():i("div",{staticClass:"mt-2"},[i("div",{staticClass:"font-weight-medium textDark--text mb-2"},[t._v(" Where should we send your crypto? ")]),i("module-address-book",{ref:"addressInput",attrs:{label:"Enter Crypto Address",currency:t.selectedCryptoName,"enable-save-address":!1,"is-home-page":!0},on:{setAddress:t.setAddress}})],1),i("mew-button",{staticClass:"mt-2",attrs:{"btn-size":"xlarge","has-full-width":"",disabled:t.disableBuy,title:t.buyBtnTitle,"is-valid-address-func":t.isValidToAddress},nativeOn:{click:function(e){return t.buy.apply(null,arguments)}}}),i("buy-sell-token-select",{attrs:{open:t.openTokenSelect,"currency-items":t.currencyItems,"selected-currency":t.selectedCurrency,"set-currency":t.setCurrency,"in-wallet":t.inWallet},on:{close:function(e){t.openTokenSelect=!1}}})],1)},n=[],r=(i("13d5"),i("14d9"),i("ac1f"),i("5319"),i("caad"),i("1b74")),a=i.n(r),o=i("2ef0"),c=i("2f62"),l=i("901e"),u=i.n(l),d=i("99e5"),h=i.n(d),m=i("5ba3"),y=i("9b88"),p=i("fbdf"),f=i("ac8e"),b=i("e745"),C=i("02c9"),v=i("08e1"),x=i("4b90"),g=i("225b"),F={name:"ModuleBuyEth",components:{ModuleAddressBook:x["default"],BuySellTokenSelect:g["a"]},props:{orderHandler:{type:Object,default:()=>{}},defaultCurrency:{type:Object,default:()=>{}},inWallet:{type:Boolean,default:!1},supportedBuy:{type:Boolean,default:!1}},data(){return{openTokenSelect:!1,selectedCurrency:this.defaultCurrency,loading:!0,selectedFiat:{name:"USD",value:"USD",img:i("1db4")},fetchedData:{},currencyRates:[],amount:"300",toAddress:"",validToAddress:!1,gasPrice:"0",web3Connections:{},simplexQuote:{},showMoonpay:!0,disableCurrencySelect:!0,localCryptoAmount:"0"}},computed:{...Object(c["c"])("global",["network","getFiatValue"]),...Object(c["e"])("wallet",["web3","address"]),...Object(c["e"])("external",["currencyRate","coinGeckoTokens"]),...Object(c["c"])("external",["contractToToken"]),...Object(c["c"])("wallet",["tokensList"]),includesFeeText(){return`Includes ${this.percentFee} fee (${Object(f["b"])(this.minFee,this.currencyConfig).value} min)`},networkFeeText(){return`${this.selectedCurrency.symbol} network fee (for transfers to your wallet) ~${Object(f["b"])(this.networkFeeToFiat,this.currencyConfig).value}`},dailyLimit(){const t=this.max.moonpay,e=this.max.simplex,i=Math.max(t.toString(),e.toString());return"Daily limit: "+Object(f["b"])(i.toString(),this.currencyConfig).value},monthlyLimit(){const t=u()(this.fiatMultiplier).times(5e4);return"Monthly limit: "+Object(f["b"])(t.toString(),this.currencyConfig).value},currencyConfig(){const t=this.selectedFiat.value,e=this.currencyRate[t],i=t;return{rate:e,currency:i}},fiatMultiplier(){if(this.hasData){const t=this.fetchedData[0].conversion_rates.find(t=>t.fiat_currency===this.selectedFiatName);return t?u()(t.exchange_rate):Object(m["toBN"])(1)}return Object(m["toBN"])(1)},selectedFiatName(){return this.selectedFiat.name},actualAddress(){return this.inWallet?this.address:this.toAddress},actualValidAddress(){return!!this.inWallet||this.validToAddress},networkFee(){return Object(m["fromWei"])(u()(this.gasPrice).times(21e3).toString())},priceOb(){return Object(o["isEmpty"])(this.fetchedData)?{crypto_currency:"ETH",fiat_currency:"USD",price:"3379.08322"}:this.fetchedData[0].prices.find(t=>t.fiat_currency===this.selectedFiatName)},networkFeeToFiat(){return u()(this.networkFee).times(this.priceOb.price).toString()},minFee(){return u()(4.43).times(this.fiatMultiplier).toString()},plusFee(){const t=this.isEUR?u()(u()(.7).div(100)).times(this.amount):u()(u()(3.25).div(100)).times(this.amount),e=t.gt(this.minFee)?u()(this.amount).minus(t):u()(this.amount).minus(t).minus(this.minFee);return e.minus(this.networkFeeToFiat).toString()},plusFeeF(){return Object(f["b"])(this.plusFee,this.currencyConfig).value},percentFee(){return this.isEUR?"0.7%":"3.25%"},selectedCryptoName(){var t;return null!==(t=this.selectedCurrency)&&void 0!==t&&t.symbol?this.selectedCurrency.symbol:""},isEUR(){return"EUR"===this.selectedFiatName||"GBP"===this.selectedFiatName},disableBuy(){return!this.inWallet&&!this.actualValidAddress||this.loading||""!==this.amountErrorMessages||!this.supportedBuy},buyBtnTitle(){return"BUY NOW"},amountErrorMessages(){return u()(this.amount).isNaN()||u()(this.amount).eq(0)?"Amount required":u()(this.amount).lt(0)?"Amount can't be negative":this.min.gt(this.amount)?`Amount can't be below provider's minimum: ${Object(f["b"])(this.min.toFixed(),this.currencyConfig).value} ${this.selectedFiatName}`:this.maxVal.lt(this.amount)?`Amount can't be above provider's maximum: ${Object(f["b"])(this.maxVal.toFixed(),this.currencyConfig).value} ${this.selectedFiatName}`:""},tokens(){if(this.inWallet)return C["a"].reduce((t,e)=>{const i=this.tokensList.find(t=>{if(t.contract.toLowerCase()===e.toLowerCase())return t});if(i)return t.push(i),t;const s=this.contractToToken(e);return s&&t.push(s),t},[]);const t=new Array;for(const e of C["a"]){const i=this.contractToToken(e);i&&t.push(i)}return t},currencyItems(){if(!this.supportedBuy)return;const t=this.currencyRates.length>0?this.tokens.map(t=>{const e=this.currencyRates.find(e=>e.crypto_currency===t.symbol),i=null===e||void 0===e?void 0:e.quotes.find(t=>t.fiat_currency===this.selectedFiatName);return t.price=Object(f["b"])(i?i.price:"0",this.currencyConfig).value,t.value=t.name,t.name=t.symbol,t}):this.tokens,e=[...t];return e},hasData(){return!Object(o["isEmpty"])(this.fetchedData)},cryptoToFiat(){return this.showMoonpay?this.moonpayCryptoAmount:this.simplexCryptoAmount},moonpayCryptoAmount(){return Object(f["c"])(u()(this.plusFee).div(this.priceOb.price).toString()).value},simplexCryptoAmount(){return Object(f["c"])(this.simplexQuote.crypto_amount).value},fiatCurrencyItems(){const t=this.hasData?this.fetchedData[0].fiat_currencies.filter(t=>"RUB"!==t):["USD"];return Object(b["b"])(t)},max(){if(this.hasData){var t,e;const i=null===(t=this.fetchedData[0])||void 0===t?void 0:t.limits.find(t=>t.fiat_currency===this.selectedFiatName),s=null===(e=this.fetchedData[1])||void 0===e?void 0:e.limits.find(t=>t.fiat_currency===this.selectedFiatName);return{moonpay:i?u()(i.limit.max):u()(12e3),simplex:s?u()(s.limit.max):u()(12e3)}}return{moonpay:u()(12e3),simplex:u()(12e3)}},maxVal(){const t=this.max.moonpay,e=this.max.simplex,i=Math.max(t.toString(),e.toString());return u()(i)},min(){if(this.hasData){const t=this.fetchedData[0].limits.find(t=>t.fiat_currency===this.selectedFiatName);return t?u()(t.limit.min):u()(30)}return u()(30)},hideSimplex(){return"USDC"===this.selectedCryptoName||"USDT"===this.selectedCryptoName}},watch:{selectedCurrency:{handler:function(t,e){var i;const s={ETH:"ETH",BNB:"BNB",MATIC:"MATIC"};t&&((null===t||void 0===t||null===(i=t.contract)||void 0===i?void 0:i.toLowerCase())!==v["a"]||s[t.symbol])?(Object(o["isEqual"])(t,e)||this.fetchCurrencyData(),this.$emit("selectedCurrency",this.selectedCurrency)):this.selectedCurrency=e},deep:!0},selectedFiat:{handler:function(t,e){if(!Object(o["isEqual"])(t,e)){const e=this.currencyItems.find(t=>t.name===this.selectedCryptoName),i=e.price.substring(1).replace(",","");this.amount=u()(this.localCryptoAmount).multipliedBy(i).toFixed(2),this.localCryptoAmount=u()(this.amount).div(i).toString(),this.$emit("selectedFiat",t)}},deep:!0},network:{handler:function(){this.selectedCurrency={},this.selectedCurrency=this.defaultCurrency},deep:!0},orderHandler:{handler:function(){this.fetchCurrencyData()},deep:!0},amount:{handler:function(t){const e=this.max.simplex.multipliedBy(this.fiatMultiplier);this.checkMoonPayMax(),e.lt(t)||Object(o["isEmpty"])(t)||this.min.gt(t)||isNaN(t)?this.loading=!0:(this.loading=!1,this.getSimplexQuote(),this.localCryptoAmount=u()(this.amount).div(this.priceOb.price).toString())}},validToAddress:{handler:function(t){t&&(this.$emit("toAddress",this.toAddress),this.getSimplexQuote())}},coinGeckoTokens:{handler:function(){this.fetchCurrencyData()}},openTokenSelect(){this.$emit("openTokenSelect",this.openTokenSelect)}},mounted(){var t;this.inWallet||null===(t=this.$refs.addressInput.$refs)||void 0===t||t.addressSelect.clear(),this.fetchCurrencyData()},methods:{setAddress(t,e,i){"RESOLVED"!==i.type||i.value.includes(".")?this.toAddress=t:this.toAddress=i.value,this.validToAddress=e},async fetchGasPrice(){var t;const e={ETH:"ETH",BNB:"BSC",MATIC:"MATIC"},i=e[null===(t=this.selectedCurrency)||void 0===t?void 0:t.symbol]?e[this.selectedCurrency.symbol]:"ETH",s=p["a"][i];if(!this.web3Connections[i]){const t=new h.a(s[0].url);this.web3Connections[i]=t}this.gasPrice=await this.web3Connections[i].eth.getGasPrice()},isLT(t,e){return u()(t).lt(e)},isValidToAddress(t){return a.a.validate(t,this.selectedCurrency.symbol)},checkMoonPayMax(){const t=this.max.moonpay,e=this.isLT(t,this.amount);this.$emit("hideMoonpay",e)},setCurrency(t){this.selectedCurrency=t},fetchCurrencyData(){var t;this.loading=!0,this.disableCurrencySelect=!0,this.fetchData={},this.fetchGasPrice(),this.orderHandler.getSupportedFiatToBuy(null===(t=this.selectedCurrency)||void 0===t?void 0:t.symbol).then(t=>{this.orderHandler.getFiatRatesForBuy().then(t=>{this.currencyRates=Object(o["cloneDeep"])(t),this.loading=!1,this.disableCurrencySelect=!1}),this.fetchedData=Object.assign({},t),this.localCryptoAmount=u()(this.amount).div(this.priceOb.price).toString()}).catch(t=>{Object(y["e"])(t,{},y["a"])}),this.getSimplexQuote()},getSimplexQuote(){this.hideSimplex||!this.actualValidAddress||Object(o["isEmpty"])(this.amount)||this.min.gt(this.amount)||isNaN(this.amount)||this.max.simplex.lt(this.amount)||""!==this.amountErrorMessages||(this.loading=!0,this.disableCurrencySelect=!0,this.simplexQuote={},this.orderHandler.getSimplexQuote(this.selectedCryptoName,this.selectedFiatName,this.amount,this.actualAddress).then(t=>{this.simplexQuote=Object.assign({},t),this.loading=!1,this.disableCurrencySelect=!1,this.$emit("simplexQuote",this.simplexQuote),this.compareQuotes()}).catch(t=>{Object(y["e"])(t,{},y["a"])}))},compareQuotes(){const t=this.max.moonpay;this.showMoonpay=!this.isLT(t,this.amount)&&this.isLT(this.simplexQuote.crypto_amount,this.moonpayCryptoAmount)},buy(){const t={cryptoToFiat:this.moonpayCryptoAmount,selectedCryptoName:this.selectedCryptoName,plusFeeF:this.plusFeeF,includesFeeText:this.includesFeeText,networkFeeText:this.networkFeeText,dailyLimit:this.dailyLimit,monthlyLimit:this.monthlyLimit,fiatAmount:this.amount};this.checkMoonPayMax(),this.$emit("success",[this.simplexQuote,this.toAddress,t,1,this.selectedCurrency,this.selectedFiat])},preventCharE(t){"e"===t.key&&t.preventDefault()}}},w=F,T=(i("c675"),i("42c8"),i("2877")),k=Object(T["a"])(w,s,n,!1,null,"57a58af1",null);e["default"]=k.exports},9720:function(t,e,i){},b56e:function(t,e,i){},c675:function(t,e,i){"use strict";i("9720")}}]);
//# sourceMappingURL=../sourcemaps/js/chunk-22d2e242.9efdb1e8.js.map