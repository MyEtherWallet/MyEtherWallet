(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16224709"],{"165f":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.loading?i("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"300",type:"avatar"}}):e._e(),e.loading?e._e():i("div",{staticClass:"d-flex align-center"},[i("v-btn",{attrs:{icon:""},on:{click:e.openNotifications}},[i("img",{class:[e.invertIcon?"make-white-svg":""],attrs:{src:n("dfaa")}})]),e.newNotificationCount>0?i("div",{staticClass:"notification-count pa-3 cursor--pointer d-flex align-center justify-center white--text error lighten2",on:{click:e.openNotifications}},[e._v(" "+e._s(e.newNotificationCount)+" ")]):e._e()],1),i("mew-overlay",{attrs:{footer:{text:"Need help?",linkTitle:"Contact support",link:"mailto:support@myetherwallet.com"},title:"Notifications","content-size":"large","show-overlay":e.isOpenNotifications,close:e.closeNotifications}},[i("v-sheet",{staticClass:"transparent",attrs:{"max-width":"735px",width:"100%"}},[i("v-sheet",{staticClass:"d-flex align-center justify-space-between mx-auto mb-6",attrs:{color:"transparent","max-width":"350px"}},[i("div",[i("v-icon",{attrs:{color:"greenPrimary",large:""}},[e._v(" mdi-circle-medium ")]),e._v(" Success ")],1),i("div",[i("v-icon",{attrs:{color:"orangePrimary",large:""}},[e._v(" mdi-circle-medium ")]),e._v(" Pending ")],1),i("div",[i("v-icon",{attrs:{color:"redPrimary",large:""}},[e._v(" mdi-circle-medium ")]),e._v(" Failed ")],1)]),e.hasNotification?i("div",{staticClass:"d-flex align-center justify-end"},[i("v-sheet",{attrs:{color:"transparent","max-width":"150px"}},[i("mew-select",{attrs:{items:e.items,"has-filter":!1,"normal-dropdown":""},on:{input:e.setSelected}})],1)],1):e._e(),e._l(e.notificationsByType,(function(t,n){return i("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading&&e.notificationsByType.length>0,expression:"!loading && notificationsByType.length > 0"}],key:n,staticClass:"mt-2"},[i("mew-notification",{attrs:{notification:t.notification},nativeOn:{click:function(n){return e.markNotificationAsRead(t)}}})],1)})),i("div",{directives:[{name:"show",rawName:"v-show",value:0===e.notificationsByType.length,expression:"notificationsByType.length === 0"}],staticClass:"pa-5 text-center"},[i("h3",{staticClass:"mb-5"},[e._v("No notifications to display for:")]),i("h3",{staticClass:"break-hash"},[e._v(e._s(e.address))])])],2)],1)],1)},a=[],s=(n("4e82"),n("13d5"),n("14d9"),n("2f62")),r=n("25ed"),o=n("295b"),c=n("9901"),d=n("068e"),l=(n("caad"),n("3c65"),n("1b00")),u=n("9b88");const m={cannotReturnNull:"Cannot return null for non-nullable field Query.getTransactionByHash."},h=15;var v={name:"HandlerNotification",data(){return{getEthTransfersV2:"",getTransactionsByHashes:"",newPendingTransaction:"",getTransactionByHash:"",subscribeToTxHash:"",txHash:"",initialLoad:!0,txHashes:[],ethTransfersIncoming:[]}},apollo:{getEthTransfersV2:{query:l["getEthTransfersV2"],variables(){return{owner:this.address,limit:h}},skip(){return!this.isEthNetwork||null===this.address||""===this.address},result({data:e}){e&&e.getEthTransfersV2.transfers&&e.getEthTransfersV2.transfers.forEach(e=>{const t=e.transfer.transactionHash;!this.txHashes.includes(t)&&this.txHashes.push(t)})},error(e){Object(u["e"])(e.message,{},u["a"])}},getTransactionsByHashes:{query:l["getTransactionsByHashes"],variables(){return{hashes:this.txHashes}},fetchPolicy:"cache-and-networ`k`",skip(){return!this.isEthNetwork||0===this.txHashes.length},result({data:e}){e&&e.getTransactionsByHashes&&(this.ethTransfersIncoming=e.getTransactionsByHashes)},error(e){Object(u["e"])(e.message,{},u["a"])}},getTransactionByHash:{query:l["getTransactionByHash"],variables(){return{hash:this.txHash}},skip(){return!this.isEthNetwork||!this.txHash||""===this.txHash||null===this.txHash},update:e=>e.getTransactionByHash,result({data:e}){if(e){const t=e.getTransactionByHash;if(t.to===this.address){const e=this.ethTransfersIncoming,n=e.findIndex(e=>{if(t.hash===e.hash)return e});n>=0?e.splice(n,1,t):e.unshift(t),this.ethTransfersIncoming=e}}},error(e){e.message.includes(m.cannotReturnNull)||Object(u["e"])(e.message,{},u["a"])}},$subscribe:{newPendingTransaction:{query:l["pendingTransaction"],variables(){return{owner:this.address}},skip(){return!this.isEthNetwork||""===this.address||null===this.address||this.loading},result({data:e}){if(e&&e.pendingTransaction){var t;const n=e.pendingTransaction;(null===(t=n.to)||void 0===t?void 0:t.toLowerCase())===this.address&&(this.txHash=n.transactionHash)}},error(e){Object(u["e"])(e.message,{},u["a"])}},subscribeToTxHash:{query:l["transactionEvent"],variables(){return{hash:this.txHash}},skip(){return!this.isEthNetwork||!this.txHash||""===this.txHash||null===this.txHash},result(){var e;null===(e=this.$apollo.queries.getTransactionByHash)||void 0===e||e.refetch()},error(e){Object(u["e"])(e.message,{},u["a"])}}}}},f=n("8ca2"),k=n("3c5b7"),g={name:"ModuleNotifications",mixins:[v],props:{invertIcon:{type:Boolean,default:!1}},data(){return{selected:r["b"].ALL,items:[{name:"All",value:r["b"].ALL},{name:"In",value:r["b"].IN},{name:"Out",value:r["b"].OUT},{name:"Swap",value:r["b"].SWAP}],isOpenNotifications:!1}},computed:{...Object(s["c"])("notifications",["currentNotifications","txNotifications","swapNotifications"]),...Object(s["c"])("global",["network","isEthNetwork"]),...Object(s["e"])("wallet",["address","web3"]),loading(){return this.$apollo.loading},swapper(){return new f["a"](this.web3,this.network.type.name)},outgoingTxNotifications(){return this.txNotifications.map(e=>e.hasOwnProperty("hash")?Object(o["a"])(e,this.network):Object(c["a"])(e)).sort(this.sortByDate)},incomingTxNotifications(){const e=this.address?this.address.toLowerCase():"";return this.loading?[]:this.ethTransfersIncoming.reduce((t,n)=>{var i;return(null===(i=n.to)||void 0===i?void 0:i.toLowerCase())===e&&(n.type=r["b"].IN,n.status?n.read=!0:n.read=!1,n.hasOwnProperty("hash")?(n=new r["c"](n),t.push(Object(o["a"])(n,this.network))):(n=new k["a"](n),t.push(Object(c["a"])(n)))),t},[]).sort(this.sortByDate)},allNotifications(){const e=this.formattedCurrentNotifications().concat(this.incomingTxNotifications);return e.sort(this.sortByDate),e.slice(0,20)},notificationsByType(){switch(this.selected){case r["b"].IN:return this.incomingTxNotifications.slice(0,20).sort(this.sortByDate);case r["b"].OUT:return this.outgoingTxNotifications.slice(0,20).sort(this.sortByDate);case r["b"].SWAP:return this.swapNotifications.slice(0,20).sort(this.sortByDate);default:return this.allNotifications}},newNotificationCount(){const e=this.allNotifications.filter(e=>{if(!e.read)return e});return e.length},hasNotification(){return this.allNotifications.length>0}},watch:{currentNotifications:{handler:function(e){e.forEach(e=>{this.checkAndSetNotificationStatus(e)})},deep:!0}},mounted(){const e=this;d["a"].$on("openNotifications",()=>{e.openNotifications()}),e.currentNotifications.forEach(t=>{e.checkAndSetNotificationStatus(t)})},beforeDestroy(){d["a"].$off("openNotifications")},methods:{...Object(s["b"])("notifications",["updateNotification"]),setSelected(e){this.selected=e.value},sortByDate(e,t){return new Date(t.date)-new Date(e.date)},formattedCurrentNotifications(){return this.currentNotifications.map(e=>e.hasOwnProperty("hash")?Object(o["a"])(e,this.network):Object(c["a"])(e))},checkAndSetNotificationStatus(e){const t=e.type;e.status&&(t===r["b"].SWAP&&e.status.toLowerCase()===r["a"].PENDING&&e.checkSwapStatus(this.swapper),t===r["b"].OUT&&e.status.toLowerCase()===r["a"].PENDING&&this.web3.eth.getTransactionReceipt(e.hash).then(t=>{t&&(e.status=t.status?r["a"].SUCCESS:r["a"].FAILED,this.updateNotification(e))}))},markNotificationAsRead(e){e.read||e.markAsRead().then(()=>{const t=e.type.toLowerCase();t===r["b"].OUT||t===r["b"].SWAP?this.updateNotification(e):e.read=!0})},openNotifications(){this.isOpenNotifications=!0},closeNotifications(){this.isOpenNotifications=!1}}},p=g,N=(n("5f5a"),n("2877")),b=Object(N["a"])(p,i,a,!1,null,"4aa278be",null);t["default"]=b.exports},"1b00":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getEthTransfersV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"owner"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"nextKey"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getEthTransfersV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"owner"},value:{kind:"Variable",name:{kind:"Name",value:"owner"}}},{kind:"Argument",name:{kind:"Name",value:"direction"},value:{kind:"EnumValue",value:"OUTGOING"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"nextKey"},value:{kind:"Variable",name:{kind:"Name",value:"nextKey"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"transfers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"transfer"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"transactionHash"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"nextKey"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getTransactionsByHashes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hashes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getTransactionsByHashes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hashes"},value:{kind:"Variable",name:{kind:"Name",value:"hashes"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"gas"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"gasPrice"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"gasUsed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timestamp"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonce"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"input"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getTransactionByHash"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getTransactionByHash"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hash"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"gas"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"gasPrice"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"gasUsed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timestamp"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonce"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"input"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"pendingTransaction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"owner"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pendingTransaction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"owner"},value:{kind:"Variable",name:{kind:"Name",value:"owner"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"transactionHash"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"transactionEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"transactionEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hash"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],directives:[]}]}}],loc:{start:0,end:897}};n.loc.source={body:"query getEthTransfersV2($owner: String!, $limit: Int, $nextKey: String) {\n  getEthTransfersV2(\n    owner: $owner\n    direction: OUTGOING\n    limit: $limit\n    nextKey: $nextKey\n  ) {\n    transfers {\n      transfer {\n        transactionHash\n      }\n    }\n    nextKey\n  }\n}\n\nquery getTransactionsByHashes($hashes: [String]!) {\n  getTransactionsByHashes(hashes: $hashes) {\n    from\n    gas\n    gasPrice\n    gasUsed\n    hash\n    timestamp\n    nonce\n    to\n    value\n    input\n    status\n  }\n}\n\nquery getTransactionByHash($hash: String!) {\n  getTransactionByHash(hash: $hash) {\n    from\n    gas\n    gasPrice\n    gasUsed\n    hash\n    timestamp\n    nonce\n    to\n    value\n    input\n    status\n  }\n}\n\nsubscription pendingTransaction($owner: String) {\n  pendingTransaction(owner: $owner) {\n    transactionHash\n    to\n  }\n}\n\nsubscription transactionEvent($hash: String!) {\n  transactionEvent(hash: $hash)\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var a={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=a[t]||new Set,r=new Set,o=new Set;i.forEach((function(e){o.add(e)}));while(o.size>0){var c=o;o=new Set,c.forEach((function(e){if(!r.has(e)){r.add(e);var t=a[e]||new Set;t.forEach((function(e){o.add(e)}))}}))}return r.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}(function(){n.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),a[e.name.value]=t}}))})(),e.exports=n,e.exports["getEthTransfersV2"]=r(n,"getEthTransfersV2"),e.exports["getTransactionsByHashes"]=r(n,"getTransactionsByHashes"),e.exports["getTransactionByHash"]=r(n,"getTransactionByHash"),e.exports["pendingTransaction"]=r(n,"pendingTransaction"),e.exports["transactionEvent"]=r(n,"transactionEvent")},"295b":function(e,t,n){"use strict";n("ac1f"),n("5319");var i=n("eb5b"),a=n("5ba3"),s=n("ac8e");const r=(e,t)=>{var n,r;const o=t.type.isEthVMSupported,c=o.supported?o.blockExplorerTX:t.type.blockExplorerTX,d={txHash:{value:e.hash?e.hash:"",string:"Transaction Hash",link:""+(c?c.replace("[[txHash]]",e.hash):"")},gasPrice:{value:Object(s["e"])(Object(a["fromWei"])(e.gasPrice,"gwei"))+" Gwei",string:"Gas Price"},gasLimit:{value:Object(s["e"])(Object(a["toBN"])(e.gas).toString()),string:"Gas Limit"},total:{value:`${Object(s["c"])(Object(a["fromWei"])(e.transactionFee,"ether")).value} ${t.type.currencyName}`,string:"Total Transaction fee"},to:{value:e.toTxData&&e.toTxData.to?e.toTxData.to:e.to,string:"To"},from:{value:e.from,string:"From"},amount:{value:`${Object(s["c"])(Object(a["fromWei"])(e.value,"ether")).value} ${t.type.currencyName}`,string:"Amount"},timestamp:{value:Object(i["a"])(Object(a["toBN"])(e.date).toNumber()),string:"Time"},status:{value:null===(n=e.status)||void 0===n?void 0:n.toLowerCase(),string:"Status"},type:{value:null===(r=e.type)||void 0===r?void 0:r.toLowerCase(),string:e.type},read:e.read,toObj:e.toTxData,fromObj:e.fromTxData};return d.toObj&&d.toObj.amount&&(d.toObj.amount=Object(s["c"])(d.toObj.amount).value),d.fromObj&&d.fromObj.amount&&(d.fromObj.amount=Object(s["c"])(d.fromObj.amount).value),e.notification=d,e};t["a"]=r},"5f5a":function(e,t,n){"use strict";n("c092")},9901:function(e,t,n){"use strict";var i=n("eb5b"),a=n("5ba3");const s=e=>{var t,n;const s={to:{value:e.toTxData&&e.toTxData.to?e.toTxData.to:e.to,string:"To"},from:{value:e.from,string:"From"},timestamp:{value:Object(i["a"])(Object(a["toBN"])(e.date).toNumber()),string:"Time"},status:{value:null===(t=e.status)||void 0===t?void 0:t.toLowerCase(),string:"Status"},type:{value:null===(n=e.type)||void 0===n?void 0:n.toLowerCase(),string:e.type},read:e.read,toObj:e.toTxData,fromObj:e.fromTxData};return e.notification=s,e};t["a"]=s},c092:function(e,t,n){},dfaa:function(e,t,n){e.exports=n.p+"img/icon-notifications.09e377be.svg"},eb5b:function(e,t,n){"use strict";const i=31536e3,a=2592e3,s=86400,r=3600,o=60;t["a"]=e=>{const t=new Date(e),n=Math.floor((new Date-t)/1e3),c=Math.floor(n/i),d=Math.floor(n/a),l=Math.floor(n/s),u=Math.floor(n/r),m=Math.floor(n/o);return c>1?c+" years ago":d>1?d+" months ago":l>1?l+" days ago":u>1?u+" hours ago":m>1?m+" minutes ago":Math.floor(n)+" seconds ago"}}}]);
//# sourceMappingURL=../sourcemaps/js/chunk-16224709.ab876cf0.js.map