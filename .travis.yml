language: node_js
node_js: '7'
sudo: required
dist: trust
branches:
  except:
    - gh-pages
stages:
  - remove .gitignore
  - lint code
  - build application
  - name: create release
    if: branch = master and type != pull_request
  - name: deploy to production
    if: branch = master and type != pull_request
  - name: send release
    if: branch = master and type != pull_request
jobs:
  fast_finish: true
  include:
    - stage: remove .gitignore
      script: rm .gitignore
    - stage: lint code
      script: npm run lint
    - stage: build application
      script: npm run build
    - stage: create release
      script: ./release.sh
    - stage: send release
      script: skip
      provider: releases
      api_key:
        secure: $GITHUB_API_KEY
      file_blog: true
      file: deploy/*
      skip_cleanup: true
      on:
        repo: gamalielhere/MyEtherWallet
    - stage: deploy to production
      script: npm run deploy
